{"version":3,"sources":["tree.js"],"names":["idrecode","subTree","item","dataAry","deep","nsons","sons","o","parent","idf","map","son","ii","itemClass","indexOf","push","concat","li","owerTree","ary","Array","isArray","module","exports","menus","ref"],"mappings":"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","file":"../tree.js","sourcesContent":["// 数据结构\n// const _data = [\n//   {title: '典型页面', content: '123', idf: 'aaa'},\n//   {title: '典型页面1', content: 'aaa', idf: 'bbb', parent: 'aaa'},\n//   {title: '典型页面2', content: 'bbb', parent: 'aaa', attr: {\"href\":'http://www.163.com'}},\n//   {title: '典型页面3', content: 'ccc', parent: 'aaa'},\n//   {title: '典型页面4', content: 'ddd', parent: 'bbb'},\n//   {title: '典型页面5', content: 'eee', parent: 'bbb'},\n//   {title: '导航', content: '111'},\n//   {title: '表单', content: '333'},\n//   {title: '列表', content: '444'},\n//   {title: '高级搜索', content: '5555'}\n// ]\n\n// resault\n// [\n//   {title: '典型页面', url: undefined, li: [{title: '典型页面1', url: undefined, li:[{典型页面4..}, {典型页面5..}]}, {典型页面2..}, {典型页面3...}]},\n//   {title: '导航', content: '111'},\n//   {title: '表单', content: '333'},\n//   {title: '列表', content: '444'},\n//   {title: '高级搜索', content: '5555'}\n// ]\n\n// html\n// 将结果交给widget/ListView组件,拼接 ul/li 的结构化数据\n// <List data={resault} />\n\n// <li class=\"item ...\">\n// \t<div class=\"itemroot\">\n// \t\t<ul>\n// \t\t\t<li data-href=\"http://www.163.com\">xxx</li>\n// \t\t</ul>\n// \t</div>\n// </li>\n\n// let idrecode = {}\n\nimport filter from 'lodash.filter'\nlet idrecode = []\nfunction subTree(item, dataAry, deep){\n\tdeep = deep||1\n\tlet nsons = []\n\tlet sons = filter(dataAry, o => o.parent == item.idf)\n\tsons.map( (son, ii) => {\n\t\tson.itemClass = son.itemClass&&son.itemClass.indexOf('level'+deep)==-1 ? son.itemClass +' level'+deep : 'level'+deep\n\t\t// son.itemClass = son.itemClass ? son.itemClass +' level'+deep : 'level'+deep\n\t\tif (son.idf && idrecode.indexOf(son.idf) == -1) {\n\t\t\tidrecode.push(son.idf)\n\t\t\tnsons = nsons.concat([subTree(son, dataAry, ++deep)])\n\t\t\t--deep\n\t\t} else {\n\t\t\tnsons = nsons.concat(son)\n\t\t}\n\t})\n\titem.li = nsons\n\treturn item\n}\n\nfunction owerTree(item) {\n\tlet ary = item.map( o => {\n\t\tif (Array.isArray(o)) return owerTree(item)\n\t\treturn o\n\t})\n\treturn {li: ary}\n}\n\n// TreeStructor\nmodule.exports = function(dataAry){\n\tlet menus = []\n\tidrecode = []\n\tdataAry.map( (item, ii)=>{\n\t\tif (typeof item == 'string') menus.push(item)\n\t\tif (typeof item == 'object' && !Array.isArray(item)) {\n\t\t// if (_.isPlainObject(item)) {\n\t\t\tif (item['attr']) {\n\t\t\t\tif (!item['attr']['data-treeid']) item['attr']['data-treeid'] = ii\n\t\t\t} else {\n\t\t\t\titem['attr'] ={'data-treeid': ii}\n\t\t\t}\n\t\t\tif (item.idf && !item.parent && idrecode.indexOf(item.idf) == -1) {\n\t\t\t\titem.itemClass = item.itemClass && item.itemClass.indexOf('level0') == -1 ? item.itemClass +' level0' : 'level0'\n\t\t\t\titem.ref = item.idf\n\t\t\t\tmenus.push(subTree(item, dataAry))\n\t\t\t}\n\t\t\tif (!item.idf && !item.parent) {\n\t\t\t\tmenus.push(item)\n\t\t\t}\n\t\t}\n\t\tif (Array.isArray(item)) {\n\t\t\tmenus.push(owerTree(item))\n\t\t}\n\t})\n\treturn menus\n}\n"]}